<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="CreateSimpleProductTest">
        <annotations>
            <features value="Catalog"/>
            <stories value="Create Product"/>
            <title value="Admin should be able to create simple product."/>
            <description value="Admin should be able to create simple product."/>
            <severity value="MAJOR"/>
            <group value="Catalog"/>
            <group value="alex" />
        </annotations>
        <before>
            <!-- Login to Admin panel -->
            <amOnPage url="admin" stepKey="openAdminPanelPage" />
            <fillField selector="#username" userInput="admin" stepKey="fillLoginField" />
            <fillField selector="#login" userInput="123123q" stepKey="fillPasswordField" />
            <click selector="#login-form .action-login" stepKey="clickLoginButton" />
        </before>
        <after>
            <!-- Logout from Admin panel -->
        </after>

        <!-- Navigate to Catalog -> Products page (or just open by link) -->
        <amOnPage url="admin/catalog/product/index" stepKey="openProductGridPage" />

        <!-- Click "Add Product" button -->
        <click selector="#add_new_product-button" stepKey="clickAddProductButton" />
        <waitForPageLoad stepKey="waitForNewProductPageOpened" />

        <!-- Fill field "Name" with "Simple Product %unique_value%" -->
        <fillField selector="input[name='product[name]']" userInput="Simple Product 12412431" stepKey="fillNameField" />

        <!-- Fill field "SKU" with "simple_product_%unique_value%" -->
        <fillField selector="input[name='product[sku]']" userInput="simple-product-12412431" stepKey="fillSKUField" />

        <!-- Fill field "Price" with "500.00" -->
        <fillField selector="input[name='product[price]']" userInput="500.00" stepKey="fillPriceField" />

        <!-- Fill field "Quantity" with "100" -->
        <fillField selector="input[name='product[quantity_and_stock_status][qty]']" userInput="100" stepKey="fillQtyField" />

        <!-- Fill field "Weight" with "100" -->
        <fillField selector="input[name='product[weight]']" userInput="100" stepKey="fillWeightField" />

        <!-- Click "Save" button -->
        <click selector="#save-button" stepKey="clickSaveButton" />
        <waitForPageLoad stepKey="waitForProductIsSaved" />
        <!-- See success save message "You saved the product." -->
        <see selector="[data-ui-id='messages-message-success']" userInput="You saved the product." stepKey="seeSuccessMessage" />

        <!-- Navigate to Catalog -> Products page (or just open by link) -->
        <amOnPage url="admin/catalog/product/index" stepKey="openProductGridPageToVerifySavedProduct" />

        <!-- See created product is in grid -->
        <click selector=".//div[@class='admin__data-grid-header'][(not(ancestor::*[@class='sticky-header']) and not(contains(@style,'visibility: hidden'))) or (ancestor::*[@class='sticky-header' and not(contains(@style,'display: none'))])]//button[@data-action='grid-filter-expand']" stepKey="clickFiltersButton" />

        <!-- See "Name" in grid is valid -->
        <fillField selector="input[name='name']" userInput="Simple Product 12412431" stepKey="fillNameFilterField" />

        <!-- See "SKU" in grid is valid -->
        <fillField selector="input[name='sku']" userInput="simple-product-12412431" stepKey="fillSkuFilterField" />

        <!-- See "Price" in grid is valid -->
        <fillField selector="input[name='price[from]']" userInput="500.00" stepKey="fillPriceFromFilterField" />
        <fillField selector="input[name='price[to]']" userInput="500.00" stepKey="fillPriceToFilterField" />

        <!-- See "Quantity" in grid is valid -->
        <fillField selector="input[name='qty[from]']" userInput="100" stepKey="fillQtyFromFilterField" />
        <fillField selector="input[name='qty[to]']" userInput="100" stepKey="fillQtyToFilterField" />

        <click selector=".//div[@class='admin__data-grid-header'][(not(ancestor::*[@class='sticky-header']) and not(contains(@style,'visibility: hidden'))) or (ancestor::*[@class='sticky-header' and not(contains(@style,'display: none'))])]//button[@data-action='grid-filter-apply']" stepKey="clickApplyFilterButton" />
        <waitForPageLoad stepKey="waitForFiltersApplied" />

        <dontSee selector=".data-grid-tr-no-data" userInput="We couldn't find any records." stepKey="dontSeeCouldntFindMessage" />

        <!-- Open Storefront Product Page and verify "Name", "SKU", "Price" -->
        <amOnPage url="simple-product-12412431.html" stepKey="openProductOnStorefront" />
        <see selector="[itemprop='name']" userInput="Simple Product 12412431" stepKey="seeProductName" />
        <see selector="[itemprop='sku']" userInput="simple-product-12412431" stepKey="seeProductSku" />
        <see selector="[itemprop='offers']" userInput="$500.00" stepKey="seeProductPrice" />
    </test>
</tests>
